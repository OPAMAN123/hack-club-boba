<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hack Club Boba Builder</title>
    <!-- Load Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f3f1; /* Light cream background */
        }
        .boba-cup {
            /* Custom CSS for the cup visualization */
            background-color: #ffffff;
            border: 4px solid #4a2c22;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            position: relative;
        }
        .boba-cup::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 15px;
            background-color: #4a2c22;
            border-radius: 8px 8px 0 0;
        }
        /* Custom scrollbar for aesthetic */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background: #8B5CF6;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #f7f3f1;
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen">

    <div class="max-w-4xl mx-auto">
        <header class="text-center mb-10">
            <h1 class="text-5xl font-extrabold text-[#8B5CF6] tracking-tight">
                Hack Club Boba Tea Builder
            </h1>
            <p class="mt-2 text-xl text-gray-600">
                Design your perfect drink and see the final price!
            </p>
        </header>

        <main class="grid lg:grid-cols-3 gap-8">
            <!-- Builder Interface (2/3 width on large screens) -->
            <div id="builder-interface" class="lg:col-span-2 space-y-8 p-6 bg-white rounded-xl shadow-2xl border border-gray-100">

                <!-- Tea Base Selection -->
                <section>
                    <h2 class="text-3xl font-bold mb-4 text-gray-800 border-b pb-2">1. Choose Your Base</h2>
                    <div id="base-options" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Options will be injected here by JS -->
                    </div>
                </section>

                <!-- Flavor Selection -->
                <section>
                    <h2 class="text-3xl font-bold mb-4 text-gray-800 border-b pb-2">2. Choose Your Flavor</h2>
                    <div id="flavor-options" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Options will be injected here by JS -->
                    </div>
                </section>

                <!-- Toppings Selection -->
                <section>
                    <h2 class="text-3xl font-bold mb-4 text-gray-800 border-b pb-2">3. Add Toppings (Max 2)</h2>
                    <div id="topping-options" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Options will be injected here by JS -->
                    </div>
                </section>

                <!-- Action Button -->
                <div class="pt-4 border-t text-center">
                    <button id="checkout-button" class="bg-[#8B5CF6] hover:bg-[#6D28D9] text-white font-bold py-3 px-8 rounded-full shadow-lg transition duration-300 transform hover:scale-105" onclick="showCheckout()">
                        Finalize Order
                    </button>
                </div>

            </div>

            <!-- Summary & Visualizer (1/3 width on large screens) -->
            <div class="lg:col-span-1 space-y-6">
                
                <!-- Cup Visualization -->
                <div class="flex flex-col items-center p-6 bg-white rounded-xl shadow-2xl border border-gray-100">
                    <h3 class="text-2xl font-bold mb-4 text-gray-800">Your Custom Boba</h3>
                    
                    <div class="w-full max-w-xs h-64 boba-cup rounded-b-3xl flex flex-col justify-end overflow-hidden">
                        <div id="cup-content" class="h-full w-full">
                            <!-- Liquid and Toppings will be rendered here -->
                            <div id="liquid-layer" class="w-full transition-all duration-500 ease-in-out"></div>
                            <div id="topping-layer" class="p-2 flex flex-wrap justify-center items-end h-auto"></div>
                        </div>
                        <div class="h-4 bg-[#f9c34d] w-1.5 absolute top-2 right-1/2 transform translate-x-1/2 rounded-full shadow-md"></div>
                    </div>
                </div>

                <!-- Price Summary -->
                <div class="p-6 bg-[#f0f9ff] rounded-xl shadow-xl border border-blue-200">
                    <h3 class="text-2xl font-bold mb-4 text-blue-800">Order Summary</h3>
                    <div class="space-y-2">
                        <div class="flex justify-between text-lg text-gray-700">
                            <span>Base Price:</span>
                            <span id="base-price">$4.00</span>
                        </div>
                        <div class="flex justify-between text-lg text-gray-700">
                            <span>Flavor Cost:</span>
                            <span id="flavor-price">$0.00</span>
                        </div>
                        <div class="flex justify-between text-lg text-gray-700">
                            <span>Toppings Cost:</span>
                            <span id="toppings-price">$0.00</span>
                        </div>
                        <div class="pt-3 border-t-2 border-dashed border-blue-300"></div>
                        <div class="flex justify-between text-2xl font-bold text-blue-900">
                            <span>Total:</span>
                            <span id="total-price">$4.00</span>
                        </div>
                    </div>
                </div>

            </div>
        </main>
        
        <!-- Checkout Modal (Hidden by default) -->
        <div id="checkout-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-xl p-8 w-full max-w-md shadow-3xl text-center">
                <h2 class="text-3xl font-bold text-[#8B5CF6] mb-4">Order Placed! 🥳</h2>
                <p class="text-lg text-gray-700 mb-6">
                    You've successfully built your custom drink for:
                </p>
                <p id="final-price-display" class="text-5xl font-extrabold text-green-600 mb-8">$5.75</p>
                <p class="text-sm text-gray-500">
                    (In a real app, this would submit your order and start preparing your drink!)
                </p>
                <button onclick="hideCheckout()" class="mt-8 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 px-6 rounded-full transition duration-150">
                    Close
                </button>
            </div>
        </div>

    </div>

    <script>
        // --- Data Definitions ---
        const PRICES = {
            base: 4.00, // Base price for any tea
        };

        const BASES = [
            { id: 'classic', name: 'Classic Milk Tea', color: '#8d6e63', emoji: '🧋' },
            { id: 'jasmine', name: 'Jasmine Green Milk Tea', color: '#a5d6a7', emoji: '🍵' },
            { id: 'taro', name: 'Taro Milk Tea', color: '#ce93d8', emoji: '🍠' },
            { id: 'fruit', name: 'Passion Fruit Tea', color: '#ffcc80', emoji: '🥭' }
        ];

        const FLAVORS = [
            { id: 'none', name: 'No Extra Flavor', price: 0.00, emoji: '✨' },
            { id: 'brownsugar', name: 'Brown Sugar Syrup', price: 0.50, emoji: '🍯' },
            { id: 'strawberry', name: 'Strawberry Puree', price: 0.75, emoji: '🍓' },
            { id: 'mango', name: 'Mango Blast', price: 0.75, emoji: '🥭' }
        ];

        const TOPPINGS = [
            { id: 'boba', name: 'Boba Pearls', price: 0.50, emoji: '⚫️' },
            { id: 'lychee', name: 'Lychee Jelly', price: 0.75, emoji: '⚪️' },
            { id: 'pudding', name: 'Egg Pudding', price: 0.75, emoji: '🍮' },
            { id: 'cheese', name: 'Cheese Foam', price: 1.50, emoji: '🧀' }
        ];

        // --- State Management ---
        let selectedBase = BASES[0].id;
        let selectedFlavor = FLAVORS[0].id;
        let selectedToppings = []; // Can hold up to 2 IDs

        // --- Utility Functions ---

        /**
         * Formats a number as a currency string.
         * @param {number} amount - The price amount.
         * @returns {string} The formatted currency string.
         */
        const formatCurrency = (amount) => {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
            }).format(amount);
        };

        /**
         * Calculates the total cost of the current order.
         * @returns {number} The total price.
         */
        const calculateTotal = () => {
            let total = PRICES.base;

            // 1. Add Flavor price
            const flavorObj = FLAVORS.find(f => f.id === selectedFlavor);
            if (flavorObj) {
                total += flavorObj.price;
            }

            // 2. Add Toppings price (Max 2)
            const validToppings = selectedToppings.slice(0, 2);
            let toppingsCost = 0;
            validToppings.forEach(toppingId => {
                const toppingObj = TOPPINGS.find(t => t.id === toppingId);
                if (toppingObj) {
                    toppingsCost += toppingObj.price;
                }
            });
            total += toppingsCost;

            return {
                total,
                basePrice: PRICES.base,
                flavorPrice: flavorObj ? flavorObj.price : 0,
                toppingsPrice: toppingsCost,
            };
        };

        // --- DOM Rendering Functions ---

        /**
         * Creates an interactive button for an option.
         * @param {string} id - The unique ID for the option.
         * @param {string} name - The display name.
         * @param {number} price - The price difference.
         * @param {string} emoji - The associated emoji.
         * @param {string} type - 'base', 'flavor', or 'topping'.
         * @returns {string} The HTML string for the button.
         */
        const createOptionButton = (id, name, price, emoji, type) => {
            const priceText = price > 0 ? ` (+${formatCurrency(price)})` : (price === 0 && type === 'topping' ? '' : ' (Base)');
            const isSelected = type === 'base' ? selectedBase === id :
                               type === 'flavor' ? selectedFlavor === id :
                               selectedToppings.includes(id);

            const activeClasses = 'bg-[#8B5CF6] border-[#6D28D9] text-white shadow-lg';
            const inactiveClasses = 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50';
            const extraToppingClasses = type === 'topping' && selectedToppings.length >= 2 && !isSelected ? 'opacity-50 cursor-not-allowed' : '';


            return `
                <button
                    data-id="${id}"
                    data-type="${type}"
                    data-price="${price}"
                    onclick="handleSelection(this)"
                    class="p-4 border-2 rounded-xl text-left transition duration-200 flex items-center justify-between ${isSelected ? activeClasses : inactiveClasses} ${extraToppingClasses}"
                    ${type === 'topping' && selectedToppings.length >= 2 && !isSelected ? 'disabled' : ''}
                >
                    <div>
                        <span class="text-xl mr-2">${emoji}</span>
                        <span class="font-semibold">${name}</span>
                    </div>
                    <span class="font-medium text-sm ml-2">${priceText}</span>
                </button>
            `;
        };

        /**
         * Renders all option buttons for a given category.
         */
        const renderOptions = () => {
            document.getElementById('base-options').innerHTML = BASES.map(b =>
                createOptionButton(b.id, b.name, PRICES.base, b.emoji, 'base')
            ).join('');

            document.getElementById('flavor-options').innerHTML = FLAVORS.map(f =>
                createOptionButton(f.id, f.name, f.price, f.emoji, 'flavor')
            ).join('');

            document.getElementById('topping-options').innerHTML = TOPPINGS.map(t =>
                createOptionButton(t.id, t.name, t.price, t.emoji, 'topping')
            ).join('');

            updateSummary();
        };

        /**
         * Updates the price summary and cup visualization.
         */
        const updateSummary = () => {
            const { total, basePrice, flavorPrice, toppingsPrice } = calculateTotal();

            // 1. Update Price Summary
            document.getElementById('base-price').textContent = formatCurrency(basePrice);
            document.getElementById('flavor-price').textContent = formatCurrency(flavorPrice);
            document.getElementById('toppings-price').textContent = formatCurrency(toppingsPrice);
            document.getElementById('total-price').textContent = formatCurrency(total);

            // 2. Update Cup Visualization
            const baseObj = BASES.find(b => b.id === selectedBase) || BASES[0];
            const toppingLayer = document.getElementById('topping-layer');
            const liquidLayer = document.getElementById('liquid-layer');

            // Set liquid color and height
            liquidLayer.style.backgroundColor = baseObj.color;
            liquidLayer.style.height = 'calc(100% - 1.5rem)'; // Fill most of the cup

            // Render toppings inside the liquid
            let toppingHTML = '';
            selectedToppings.slice(0, 2).forEach(toppingId => {
                const toppingObj = TOPPINGS.find(t => t.id === toppingId);
                if (toppingObj) {
                    // Render emoji multiple times to simulate volume
                    for(let i = 0; i < (toppingId === 'boba' ? 8 : 4); i++) {
                        toppingHTML += `<span class="text-xl p-1 leading-none">${toppingObj.emoji}</span>`;
                    }
                }
            });

            // Special handling for Cheese Foam (it sits on top)
            const hasCheeseFoam = selectedToppings.includes('cheese');
            if(hasCheeseFoam) {
                 // Push the rest of the content down by simulating a top layer
                liquidLayer.style.height = 'calc(100% - 3.5rem)';
                toppingHTML = `<div class="w-full bg-white bg-opacity-70 h-8 absolute top-0 left-0 border-b border-gray-300 flex items-center justify-center font-bold text-sm text-gray-700">🧀 Foam Topping</div>` + toppingHTML;
            } else {
                liquidLayer.style.height = 'calc(100% - 1.5rem)';
            }

            toppingLayer.innerHTML = toppingHTML;
            toppingLayer.className = `p-2 absolute bottom-0 w-full flex flex-wrap justify-center ${hasCheeseFoam ? 'h-auto' : 'h-1/4 items-end'}`;
        };

        // --- Event Handlers ---

        /**
         * Handles the click event for any option button.
         * @param {HTMLElement} button - The button element that was clicked.
         */
        const handleSelection = (button) => {
            const id = button.getAttribute('data-id');
            const type = button.getAttribute('data-type');

            if (type === 'base') {
                selectedBase = id;
            } else if (type === 'flavor') {
                selectedFlavor = id;
            } else if (type === 'topping') {
                const index = selectedToppings.indexOf(id);

                if (index > -1) {
                    // Deselect
                    selectedToppings.splice(index, 1);
                } else if (selectedToppings.length < 2) {
                    // Select (max 2)
                    selectedToppings.push(id);
                } else {
                    // If max reached, but user clicked an unselected one, ignore/inform
                    console.log("Max 2 toppings reached.");
                    return;
                }
            }

            // Re-render to update selected state on all buttons and update summary
            renderOptions();
        };

        /**
         * Shows the checkout modal with the final price.
         */
        const showCheckout = () => {
            const { total } = calculateTotal();
            document.getElementById('final-price-display').textContent = formatCurrency(total);
            document.getElementById('checkout-modal').classList.remove('hidden');
            document.getElementById('checkout-modal').classList.add('flex');
        };

        /**
         * Hides the checkout modal.
         */
        const hideCheckout = () => {
            document.getElementById('checkout-modal').classList.add('hidden');
            document.getElementById('checkout-modal').classList.remove('flex');
        };

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Initial render
            renderOptions();
        });
    </script>

</body>
</html>

